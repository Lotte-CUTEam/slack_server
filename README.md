# Slack with Spring boot (1)

[Slack](https://join.slack.com/t/w1656554845-ewl688059/shared_invite/zt-1bjhwu7wn-gBAQswzGi5K53u5Y6~RvLQ)

# ìŠ¬ë™ í™œìš©ë²•ê³¼ ë´‡ ë§Œë“¤ê¸°

# ì™œ ìŠ¬ë™ì¸ê°€?

## ğŸ¥‡ì „ì„¸ê³„ ìŠ¬ë™ í—ˆë“¤ 1ìœ„ ë¡¯ë° eì»¤ë¨¸ìŠ¤

[ìš°ë¦¬ëŠ” Slackìœ¼ë¡œ ì¶œê·¼! Slackì—ì„œ í‡´ê·¼!](https://techblog.lotteon.com/%EC%9A%B0%EB%A6%AC%EB%8A%94-slack%EC%9C%BC%EB%A1%9C-%EC%B6%9C%EA%B7%BC-slack%EC%97%90%EC%84%9C-%ED%87%B4%EA%B7%BC-bf966aa9915d)

ë¡¯ë°ì˜ ê¸°ìˆ  ë¸”ë¡œê·¸ ê¸€ì„ ë³´ë©´ ë‹¤ì–‘í•œ ì—…ë¬´ì—ì„œ ìŠ¬ë™ì´ í•„ìˆ˜ì ìœ¼ë¡œ ìë¦¬ì¡ê³  ìˆìœ¼ë©° ë¡¯ë°ì¸¡ê³¼ì˜ ëŒ€í™”ì—ì„œë„ ìŠ¬ë™ì— ëŒ€í•œ ëŒ€ë‹¨í•œ ìë¶€ì‹¬ì´ ë“œëŸ¬ë‚  ë§Œí¼ ì˜ì¡´í•˜ê³  ìˆë‹¤. 

<aside>
ğŸ’¡ í—ˆë“¤ì´ë€? 
í—ˆë“¤ì€ ìŠ¬ë™ì˜ ìŒì„±í†µí™” ê¸°ëŠ¥ìœ¼ë¡œì„œ ì£¼ë¡œ ì˜¨ë¼ì¸ íšŒì˜ë¥¼ ì§„í–‰í• ë•Œ ì‚¬ìš©ëœë‹¤.

</aside>

## ğŸ”§ë‹¤ì–‘í•œ í™œìš©ë²•

[ì˜¤ë¥˜ ëª¨ë‹ˆí„°ë§ ìë™í™”í•´ ë³¼ê¹Œìš”?](https://techblog.lotteon.com/%EB%B3%91%EC%95%84%EB%A6%AC-%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%9D%98-%EC%9D%B8%ED%84%B4-%EC%84%B1%EC%9E%A5%EA%B8%B0-36d19c66dac9)

ë‹¤ì–‘í•œ ì•±ì„ ì—°ë™í•´ ìŠ¬ë™ ì‚¬ìš©ìê°„ì˜ ë¹ ë¥¸ ì—°ë™ì´ ê°€ëŠ¥í•˜ë©° ë´‡ì„ ì‚¬ìš©í•´ ìš´ì˜ì¤‘ì¸ ì„œë²„ ìƒíƒœì˜ ëŒ€í•œ ì¶”ì  ë° ê°ì‹œê°€ ê°€ëŠ¥í•˜ë‹¤.

# ì•± ì—°ë™

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7a0f0c86-5bcd-4582-9e34-d047daaea2ef/Untitled.png)

ìŠ¬ë™ì—ì„œ ì œê³µí•˜ëŠ” ë‹¤ì–‘í•œ ì•±ì„ ì—°ë™í•¨ìœ¼ë¡œ ìŠ¬ë™ ë‚´ë¶€ì ìœ¼ë¡œ í¸ë¦¬í•˜ê³  ë¹ ë¥´ê²Œ ì„œë¹„ìŠ¤ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

## ğŸ›ï¸ ëŒ€í‘œ ì„œë¹„ìŠ¤

### GitHub ì„œë²„

![ì¶”ì í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ or ì˜¤ê°€ë‹ˆì œì´ì…˜ì— ë³€ê²½ì‚¬í•­ ë°œìƒì‹œ ì•Œë ¤ì£¼ëŠ” ì„œë¹„ìŠ¤](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9d59b5d2-644e-453a-84fe-a2bb767d47ba/Untitled.png)

ì¶”ì í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ or ì˜¤ê°€ë‹ˆì œì´ì…˜ì— ë³€ê²½ì‚¬í•­ ë°œìƒì‹œ ì•Œë ¤ì£¼ëŠ” ì„œë¹„ìŠ¤

### Zoom

![/zoom ëª…ë ¹ì–´ í•˜ë‚˜ë¡œ ì¤Œë°© ì¦‰ì‹œ ìƒì„±ë¶€í„° ì°¸ì—¬ íƒˆí‡´ê¹Œì§€ ê°€ëŠ¥í•˜ë‹¤.](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2056fa83-10a8-47be-937c-a98b0f19347e/Untitled.png)

/zoom ëª…ë ¹ì–´ í•˜ë‚˜ë¡œ ì¤Œë°© ì¦‰ì‹œ ìƒì„±ë¶€í„° ì°¸ì—¬ íƒˆí‡´ê¹Œì§€ ê°€ëŠ¥í•˜ë‹¤.

# ìŠ¬ë™ ë´‡

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/577ec1b3-a5c4-45e5-bc13-473f429bec0b/Untitled.png)

## ğŸ¤–ìŠ¬ë™ ìì²´ ì œê³µ ë´‡

ê°„ë‹¨í•˜ê³  ë¹ ë¥´ê²Œ ìƒì„± ë° í™œìš©ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ë³µì¡í•œ ê¸°ëŠ¥ì„ ë„£ì„ ìˆ˜ ì—†ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bf2c39c4-4f58-4660-97e3-41e40eacc1aa/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6c87b727-0690-4d56-8464-bbd0f21c6b0f/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ade08db2-69f9-4c29-a00c-b1914d7e376b/Untitled.png)

---

## ğŸ¤–Spring Boot + Slack Bot

ìš´ì˜ì¤‘ì¸ ì‹œìŠ¤í…œê³¼ ì—°ë™í•˜ì—¬ ì‹œìŠ¤í…œì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ ë“±ì˜ ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ë¥¼ ìŠ¬ë™ì„ í†µí•´ ë°›ì„ ìˆ˜ ìˆë‹¤.

ì‹¤ì œ ë¡¯ë°ì—ì„œë„ ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ì¤‘ì´ë‹¤.

### í™˜ê²½

Spring boot 2.3..1 

java 1.8 ì´ìƒ

Gradle

Bolt 1.23.0

**Bolt for Java**Â ëŠ” ìµœì‹  í”Œë«í¼ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ Slack ì•±ì„ ë¹ ë¥´ê²Œ êµ¬ì¶•í•  ìˆ˜ ìˆë„ë¡ ì¶”ìƒí™” ê³„ì¸µì„ ì œê³µí•˜ëŠ” JVMì˜ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.

```java
dependencies **{
implementation 'com.slack.api:bolt-servlet:1.23.0'
}**
```

![application.properties](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ba688dbe-f4f7-46ac-b318-5a8a167fa3ee/Untitled.png)

application.properties

```java
// If you would like to run this app for a single workspace,
    // enabling this Bean factory should work for you.
     @Bean
    public AppConfig loadSingleWorkspaceAppConfig() {
        return AppConfig.builder()
                .singleTeamBotToken(System.getenv("SLACK_BOT_TOKEN"))
                .signingSecret(System.getenv("SLACK_SIGNING_SECRET"))
                .build();
    }
```

```java
// If you would like to run this app for multiple workspaces,
    // enabling this Bean factory should work for you.
    // @Bean
    public AppConfig loadOAuthConfig() {
        return AppConfig.builder()
                .singleTeamBotToken(null)
                .clientId(System.getenv("SLACK_CLIENT_ID"))
                .clientSecret(System.getenv("SLACK_CLIENT_SECRET"))
                .signingSecret(System.getenv("SLACK_SIGNING_SECRET"))
                .scope("app_mentions:read,channels:history,channels:read,chat:write")
                .oauthInstallPath("/slack/install")
                .oauthRedirectUriPath("/slack/oauth_redirect")
                .build();
    }
```

---

## ğŸ§© ë´‡ í™œìš©

ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ë‚˜ íŠ¹ì • ì¡°ê±´ì—ì„œ ìŠ¬ë™ìœ¼ë¡œ ë©”ì„¸ì§€ë¥¼ ë³´ë‚´ê²Œí•¨ìœ¼ë¡œì„œ ë¹ ë¥´ê³  ì‰½ê²Œ ë‹´ë‹¹ìì—ê²Œ ë³´ê³ ê°€ ê°€ëŠ¥í•˜ë‹¤.

### ìŠ¤ì¼€ë“ˆëŸ¬ë¥¼ í™œìš©

```java
@EnableScheduling
@Configuration
publicclassSlackScheduler {
privatefinalSlackService slackService;

publicSlackScheduler(SlackService slackService) {
this.slackService = slackService;
    }

//    @Scheduled(cron="0 0/1 * * * *") //1ë¶„
//    public void todayCocktail(){
//        slackService.postSlackMessage("ì•ˆë…•..");
//    }

@Scheduled(cron = "0 50 * * * ?")
publicvoidbreakTime(){
        slackService.postSlackMessage("ì‰¬ëŠ” ì‹œê°„~^^");
    }

    @Scheduled(cron = "0 50 12 ? * MON-FRI")
publicvoidlaunchTime(){
        slackService.postSlackMessage("ì ì‹¬ ì‹œê°„~^^");
    }

}
```

(cron = â€œì´ˆ ë¶„ ì‹œ ì¼ ì›” ë…„â€) ìˆœì„œ

### ì„œë²„ ì‹œì‘ì‹œ

```java
@Component
publicclassStartConfigimplementsCommandLineRunner{
privatefinalSlackService slackService;

publicStartConfig(SlackService slackService) {
this.slackService = slackService;
    }
    @Override
publicvoidrun(String... args) {
        Date date =newDate(System.currentTimeMillis());

//êµ¬í˜„ ë¶€ë¶„
slackService.postSlackMessage("Server started\nì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„(timestamp) : "+date);
    }
}
```

CommandLineRunnerëŠ” main ë©”ì„œë“œì™€ ê±°ì˜ ê°™ë‹¤ê³ Â ì´í•´í•˜ë©´ ëœë‹¤. 
(run ë©”ì„œë“œ)"ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜"ì´ ì‹œì‘í•  ë•Œ "1íšŒ"ë§Œ í˜¸ì¶œë˜ëŠ” ì ì´ ë˜‘ê°™ê³  ë‹¤ë¥¸ ì ì€ 
staticì´ ì•„ë‹ˆë¼ëŠ” ì ì—ì„œ ì´ë“ì„ ê°€ì ¸ê°ˆ ìˆ˜ ìˆëŠ” ë¶€ë¶„ì´ ìˆë‹¤. argumentë„ mainì— ë“¤ì–´ì˜¤ëŠ” ê²ƒê³¼ ë˜‘ê°™ë‹¤

### ì„œë²„ ì¢…ë£Œì‹œ

```java
@Component
public class ShutdownEventListener implements ApplicationListener<ContextClosedEvent> {

    private final SlackService slackService;

    public ShutdownEventListener(SlackService slackService) {
        this.slackService = slackService;
    }
    @Override
    public void onApplicationEvent(ContextClosedEvent event) {
        Date date = new Date(System.currentTimeMillis());

        slackService.postSlackMessage("Server shut down \n ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„(timestamp) : "+date);
    }
}
```

ApplicationListenerëŠ” ì´ë²¤íŠ¸ì™€ ê´€ë ¨ì´ ìˆë‹¤. (onApplicationEvent ë©”ì„œë“œ)ApplicationEvent(ì¶”ìƒí´ë˜ìŠ¤)ë¥¼ ìƒì†ë°›ì€ ëª¨ë“  ì´ë²¤íŠ¸ë“¤ì„ ë„£ì„ ìˆ˜ ìˆë‹¤.
ë”°ë¼ì„œ ë‚´ê°€ ApplicationEventë¥¼ ìƒì†ë°›ì€ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ë‚´ê°€ ë§Œë“  ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ í˜¸ì¶œë  ë©”ì„œë“œë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆëŠ” ê²ƒì´ë‹¤.
ìœ„ì˜ ì˜ˆì œì—ì„œëŠ”ContextClosedEventë¥¼ ê°ì§€í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í–ˆê¸° ë•Œë¬¸ì—,ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¢…ë£Œë˜ê¸° ì§ì „ì— 1íšŒë§Œ í˜¸ì¶œëœë‹¤.ì‹¤ë¬´ì—ì„œ graceful shutdownì´ í•„ìš”í•  ë•Œ ì´ ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ë„ë¡ í•˜ì. applicationListenerì— ApplicationReadyEventë¥¼ ê°ì§€í•˜ë„ë¡ í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì˜¨ì „íˆ ì‹¤í–‰ë˜ê³ ë‚˜ì„œ 1íšŒë§Œ í˜¸ì¶œí•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.

# ì¶œì²˜

> ìë°”ìš© ìŠ¬ë™ SDK
> 
> 
> [API Client Basics](https://slack.dev/java-slack-sdk/guides/web-api-basics)
> 
> ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘, ì¢…ë£Œë  ë•Œ ìˆ˜í–‰í•  ë©”ì„œë“œ ì§€ì •í•˜ëŠ” ë°©ë²•
>
